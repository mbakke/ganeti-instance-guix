ganeti-instance-guix
====================

Create Guix instances on Ganeti!

Usage:

  $ gnt-instance add -o guix my-instance

The default configuration assumes gnt-network is configured and will
create an instance with static networking, a serial console, and an SSH
server that reuses the hosts "/root/.ssh/authorized_keys" for 'root'.

A custom configuration file can be provided by an OS parameter:

  $ gnt-instance add -o guix -O "config=$(base64 /path/to/config.scm)"

See the examples directory for a generic configuration that uses DHCP.

Other supported parameters are "commit", "branch", and "repo_uri".  If
set, 'guix pull' will be invoked before building the image.  The pulled
Guix version is saved to
/etc/ganeti/instance-guix/profiles/$INSTANCE_NAME for posterity.

If neither are set, the hosts (root user) Guix version will be used to
build the virtual machine image.

Behind the scenes, this is a simple wrapper for 'guix system vm-image'.

Installation:

  $ ./configure --sysconfdir=/etc --localstatedir=/var
  $ make && sudo make install

Dependencies:

* Guix
* util-linux
* qemu-img

Limitations:

* Configurations must consist of a single file.
* No import and export functionality yet.
* Runs with elevated privileges on the host.
** Do not use this with untrusted configuration files!
